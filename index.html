<style>
    :root { --gold: #D4AF37; --bg: #050505; --panel: #0a0a0a; --glint: rgba(212, 175, 55, 0.4); }
    
    /* Responsive Tile Logic */
    .glass-tile { 
        background: var(--panel); 
        border: 1px solid rgba(255,255,255,0.05); 
        transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1); 
        cursor: pointer; 
        border-radius: 4px; 
        display: flex; 
        flex-direction: column; 
        align-items: center; 
        justify-content: center; 
        aspect-ratio: 1/1;
        position: relative;
        overflow: hidden;
    }

    /* Interaction States */
    .glass-tile:hover { 
        border-color: var(--gold); 
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 10px 30px rgba(0,0,0,0.5), 0 0 15px var(--glint);
        background: rgba(212, 175, 55, 0.08);
    }

    .glass-tile:active { 
        transform: translateY(-2px) scale(0.98); 
        filter: brightness(1.2);
    }

    /* Scanning Glint Effect */
    .glass-tile::after {
        content: "";
        position: absolute;
        top: -100%;
        left: -100%;
        width: 300%;
        height: 300%;
        background: linear-gradient(45deg, transparent, rgba(255,255,255,0.03), transparent);
        transition: 0.5s;
        pointer-events: none;
    }
    .glass-tile:hover::after {
        top: 0; left: 0; transition: 0.8s;
    }

    /* QR ID Pass Styling */
    #qr-container { 
        background: white; 
        padding: 10px; 
        border-radius: 2px;
        box-shadow: 0 0 25px rgba(212, 175, 55, 0.2);
    }
    
    #qr canvas { max-width: 100%; height: auto !important; }

    /* Identity Modal specific */
    .identity-pass {
        animation: slideUp 0.6s ease-out forwards;
    }
    @keyframes slideUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>

<script>
    // ... (Keep your existing Supabase Consts) ...

    function renderAccessPass(alias, id) {
        document.getElementById('node-body').innerHTML = `
            <div class='identity-pass flex flex-col items-center'>
                <div id='qr-wrap' class='p-2 bg-white mb-6 border-2 border-gold shadow-xl'>
                    <div id='qr'></div>
                </div>
                <div class='text-center'>
                    <p class='text-[10px] tracking-[0.4em] text-zinc-500 uppercase mb-1'>Identity Confirmed</p>
                    <div class='gold-text font-bold text-3xl tracking-tighter serif mb-2'>${alias}</div>
                    <div class='text-[8px] font-mono text-zinc-600 opacity-50 mb-4'>SECURE_ID: ${id.slice(0,18)}...</div>
                </div>
            </div>`;
            
        document.getElementById('node-action-zone').innerHTML = `
            <div class="flex flex-col gap-3">
                <button onclick="downloadID('${alias}')" class="w-full py-4 bg-white text-black font-black uppercase text-[10px] tracking-widest hover:bg-gold transition-colors">
                    Download Access Pass â†“
                </button>
                <button onclick="closeNode()" class="w-full py-3 border border-gold/20 text-zinc-500 font-bold uppercase text-[8px] tracking-[0.3em]">
                    Exit Terminal
                </button>
            </div>`;

        // Generate high-res QR
        setTimeout(() => {
            new QRCode(document.getElementById("qr"), {
                text: `MOG-IDENTITY:${id}`,
                width: 200,
                height: 200,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });
        }, 50);
    }

    // Logic to save the QR as an Image
    function downloadID(alias) {
        const qrCanvas = document.querySelector('#qr canvas');
        if (!qrCanvas) return alert("SIGNAL INTERRUPTED");
        
        const link = document.createElement('a');
        link.download = `MOG_PASS_${alias}.png`;
        link.href = qrCanvas.toDataURL("image/png");
        link.click();
    }

    // Enhance openNode for better haptics
    function openNode(id) {
        // Trigger haptic feedback if available
        if (window.navigator && window.navigator.vibrate) {
            window.navigator.vibrate(20);
        }

        const node = NODES[id];
        const modal = document.getElementById('node-modal');
        
        document.getElementById('node-title').innerText = node.title;
        document.getElementById('node-body').innerHTML = node.body;
        document.getElementById('node-action-zone').innerHTML = node.action;
        
        modal.style.display = 'block';
        modal.classList.add('animate-in', 'fade-in', 'duration-300');
        
        if(id === 'identity') checkUserStatus();
        if(id === 'crew') loadCrew();
    }
</script>
